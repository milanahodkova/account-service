# MoneyTransfers
RESTfull-сервис для осуществления денежных преводов между резегистрированными пользователями системы. Пользователям доступны пополнение/снятие денежных средств, 
переводы между счетами с контролем валюты платежа и баланса по счету. 
Счет может быть открыт в одной из 4 валют (USD, EUR, RUB, BYN). Валюта операции должна совпадать с валютой счета.

Приложение развернуто в Docker. 

Таблицы базы данных проинициализированы и заполнены начальными данными.

Документация по проекту (подробное описание endpoints) представлена в Swagger. 

## Функционал приложения
* открытие счета в одной из 4 валют;
* пополнение/обналичивание счета с контролем валюты платежа и баланса по счету;
* денежные переводы между счетами с контролем валюты платежа и балансов по счетам;
* хранение информации о пользователе, его счетах и их балансе;
* хранение информации обо всех движениях по счетам всех пользователей;
* после каждой операции пользователю выводится информация о проведенной транзакции (JSON-формат);
* пользователь может запросить информацию обо всех операциях по счету;
* CRUD-операции с пользователями;

## Стек
* Java 21
* SpringBoot 3.1.5
* PostgreSQl
* Hibernate
* Liquibase
* Lombok
* JUnit
* Mockito
* Gradle
* Docker
* Docker Compose
* Swagger
* pgAdmin

## Порядок запуска приложения

1. Установить [docker](https://docs.docker.com/get-docker/) и docker-compose;
2. Установить Gradle. Это можно сделать по [ссылке](https://gradle.org/install/) согласно инструкциям на официальном сайте;
3. Убедиться, что настроены переменные среды, в частности JAVA_HOME;
4. Создать папку на рабочем компьютере, где будет размещен проект;
5. Склонировать репозиторий командой
```
   git clone https://github.com/YuliyaRR/MoneyTransfers.git
```
6. Запустить сборку проекта (clean+build) в модуле transfers;
7. В корне проекта выполнить команду
```
  docker-compose up
```
8. После выполнения команды выше в docker будут подняты приложение, база данных и pgAdmin;
9. Теперь приложение доступно для http-запросов по ulr http://localhost:8081 +маппинг конкретного контроллера ([см. Endpoints](#endpoints));
10. Также доступна документация в Swagger по [url](http://localhost:8081/swagger-ui/index.html);
11. Для удобства тестирования API приложения можно воспользоваться Postman. Инструкции по установке по [ссылке](https://www.postman.com/downloads/) на официальном сайте.

### Подключение через поднятый в docker pgAdmin
1. pgAdmin доступен по адресу http://localhost:82
2. Для авторизации введите логин rom@rom.com и пароль 741258;
3. Master-пароль к БД root;
4. Сервер Transfers DB/Project Transfers, база данных transfers, схема app.

## Endpoints
### Операции с пользователями
#### ***POST /users/new***
Регистрация нового пользователя в системе. Данные (имя пользователя, тип документа и его номер) передаются в теле запроса.

#### ***GET /users/{uuid}***
Получение информации о пользователе по его уникальному идентификатору (uuid), который передается в пути запроса. Ответ в формате JSON.

#### ***PUT /users/{uuid}/dt_update/{dt_update}***
Обновление информации о пользователе. В пути запроса передаются уникальный идентификатор (uuid) пользователя и дата последнего обновления. 
В теле запроса передаются данные для обновления сведений о пользователе в системе. 

#### ***DELETE /users/{uuid}***
Удаление пользователя из системы. В пути запроса передается уникальный идентификатор (uuid) пользователя.

### Операции со счетами
#### ***GET /accounts/{uuid}***
Получение информации по переданному счету, включая баланс, валюту, даты открытия и обновления, информацию о владельце.
Номер счета (uuid) передается в пути запроса.
Ответ в формате JSON с информацией о проведенной транзакции.

#### ***POST /accounts/new***
Открытие счета зарегистрированному пользователю. Одновременно доступно зачисление средств на открытый счет.
В теле запроса передаются данные о валюте счета, первоначальном балансе 
(будет произведено зачисление после открытия) и владельце счета (его уникальный идентификатор).
Ответ в формате JSON с информацией о проведенной транзакции.

#### ***PUT /accounts/replenish/{uuid}/dt_update/{dt_update}***
Операция пополнения счета наличными. Номер счета (uuid) и дата последнего обновления передается в пути запроса. 
Информация о сумме и валюте взноса передаются в теле запроса.
Ответ в формате JSON с информацией о проведенной транзакции.

#### ***PUT /accounts/withdraw/{uuid}/dt_update/{dt_update}***
Операция снятия наличных со счета. Номер счета (uuid) и дата последнего обновления передается в пути запроса.
Информация о сумме и валюте снятия передаются в теле запроса.
Ответ в формате JSON с информацией о проведенной транзакции.

#### ***PUT /transfer/withdraw/{uuid}/dt_update/{dt_update}***
Операция перевода денежных средств между счетами. Номер счета-отправителя (uuid) и дата последнего обновления передается в пути запроса.
Информация о получателе (uuid счета), сумме и валюте перевода передаются в теле запроса.
Ответ в формате JSON с информацией о проведенной транзакции.

### Операции с проведёнными транзакциями
#### ***GET /transactions/{uuid}***
Получение информации обо всех движения по счету пользователя. Номер счета (uuid) передается в пути запроса.
Ответ в формате JSON.






